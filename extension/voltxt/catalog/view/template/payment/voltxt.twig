<div class="voltxt-payment-form" style="max-width: 500px; margin: 20px auto; padding: 25px; border: 2px solid #e1e5e9; border-radius: 12px; background: #ffffff; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
  
  <div class="voltxt-header" style="margin-bottom: 20px;">
    <div class="logo-container" style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
      <div class="solana-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #9945FF 0%, #14F195 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
          <path d="M20.5 7.5L16 12l4.5 4.5L24 12l-3.5-4.5zM12 0L7.5 4.5L12 9l4.5-4.5L12 0zM12 15l-4.5 4.5L12 24l4.5-4.5L12 15zM0 12l3.5-4.5L8 12l-4.5 4.5L0 12z"/>
        </svg>
      </div>
      <div class="title-text">
        <h3 style="margin: 0; color: #2c3e50; font-size: 22px; font-weight: 600;">{{ text_title }}</h3>
      </div>
    </div>
    <p style="margin: 0; color: #6c757d; font-size: 14px;">{{ text_payment_info }}</p>
  </div>
  
  <div class="payment-details" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin: 20px 0;">
    <div class="amount-display" style="font-size: 28px; font-weight: bold; margin-bottom: 8px;">
      {{ order_total }}
    </div>
    <div class="currency-info" style="font-size: 14px; opacity: 0.9; margin-bottom: 10px;">
      {{ text_order_total }}
    </div>
    <div class="network-badge" style="display: inline-block; background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 12px;">
      {{ text_network }}: {{ network }}
    </div>
  </div>
  
  <div class="payment-info" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; font-size: 14px; color: #6c757d;">
    <div class="info-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
      <span><strong>{{ text_network }}:</strong></span>
      <span>{{ network }}</span>
    </div>
    <div class="info-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
      <span><strong>{{ text_expires_in }}:</strong></span>
      <span>{{ expiry_hours }} {{ text_hours }}</span>
    </div>
    <div class="info-row" style="display: flex; justify-content: space-between; align-items: center;">
      <span><strong>{{ text_payment_method }}:</strong></span>
      <span>{{ text_solana }}</span>
    </div>
  </div>
  
  <div class="payment-instructions" style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; text-align: left; border-radius: 0 8px 8px 0;">
    <p style="margin: 0 0 10px 0; font-size: 14px; color: #1976d2; font-weight: 600;">{{ text_payment_instructions }}</p>
    <p style="margin: 0; font-size: 13px; color: #424242;">{{ text_security_notice }}</p>
  </div>
  
  <div class="payment-actions" style="margin: 25px 0;">
    <button type="button" 
            id="voltxt-confirm-btn" 
            class="btn-confirm"
            onclick="createPaymentSession()"
            aria-label="{{ aria_payment_button }}"
            style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 40px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 16px; border: none; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);"
            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.6)';"
            onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';">
      <span class="btn-text">{{ button_confirm }}</span>
      <span class="btn-icon" style="margin-left: 8px;"><i class="fa-solid fa-arrow-right"></i></span>
    </button>
  </div>
  
  <div id="loading-message" style="display: none; margin: 20px 0;">
    <div class="spinner" role="status" aria-label="{{ aria_loading }}" style="display: inline-block; width: 20px; height: 20px; border: 2px solid #f3f3f3; border-top: 2px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px;"></div>
    <span style="color: #667eea; font-weight: 500;">{{ text_loading }}</span>
  </div>
  
  <div id="error-message" style="display: none; margin: 20px 0; padding: 15px; background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; border-radius: 8px;">
    <i class="fa-solid fa-exclamation-triangle" style="margin-right: 8px;"></i>
    <span id="error-text"></span>
  </div>
  
  <div class="payment-footer" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
    <div class="security-indicators" style="display: flex; justify-content: center; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 15px;">
      <div class="security-item" style="display: flex; align-items: center; font-size: 12px; color: #6c757d;">
        <span style="color: #28a745; margin-right: 5px;">üîí</span>
        <span>{{ text_secure_payment }}</span>
      </div>
      <div class="security-item" style="display: flex; align-items: center; font-size: 12px; color: #6c757d;">
        <span style="color: #17a2b8; margin-right: 5px;">‚ö°</span>
        <span>Fast Processing</span>
      </div>
      <div class="security-item" style="display: flex; align-items: center; font-size: 12px; color: #ffc107;">
        <span style="margin-right: 5px;">üåê</span>
        <span>Blockchain Secured</span>
      </div>
    </div>
    
    <div class="powered-by" style="font-size: 11px; color: #9ca3af; text-align: center;">
      {{ text_powered_by }} <strong>{{ text_voltxt_gateway }}</strong>
    </div>
  </div>
  
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.voltxt-payment-form .btn-confirm:disabled {
  background: #6c757d !important;
  cursor: not-allowed !important;
  transform: none !important;
  box-shadow: none !important;
}

@media (max-width: 480px) {
  .voltxt-payment-form {
    margin: 10px;
    padding: 20px 15px;
  }
  
  .payment-details {
    padding: 15px;
  }
  
  .amount-display {
    font-size: 24px !important;
  }
}
</style>

<script type="text/javascript">
var paymentProcessing = false;

function createPaymentSession() {
  var btn = document.getElementById('voltxt-confirm-btn');
  var loadingMsg = document.getElementById('loading-message');
  var errorMsg = document.getElementById('error-message');
  var errorText = document.getElementById('error-text');
  
  if (paymentProcessing || btn.disabled) {
    return;
  }
  paymentProcessing = true;
  
  // Hide any previous error messages
  errorMsg.style.display = 'none';
  
  // Update button state
  btn.disabled = true;
  btn.style.background = '#6c757d';
  var icon = btn.querySelector('.btn-icon');
  if (icon) icon.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i>';
  btn.querySelector('.btn-text').textContent = '{{ text_loading }}';
  loadingMsg.style.display = 'block';
  
  // Make AJAX request to create payment session
  fetch('{{ create_session_url }}', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Accept': 'application/json'
    },
    body: JSON.stringify({})
  })
  .then(response => response.json())
  .then(data => {
    if (data.success && data.payment_url) {
      console.log('Payment session created successfully:', data);
      console.log('Redirecting to:', data.payment_url);
      
      // Redirect to the Voltxt payment page
      window.location.href = data.payment_url;
    } else {
      console.error('Payment session creation failed:', data);
      
      // Show error message
      errorText.textContent = data.error || 'Failed to create payment session. Please try again.';
      errorMsg.style.display = 'block';
      
      // Reset button state
      resetButtonState();
    }
  })
  .catch(error => {
    console.error('Network error:', error);
    
    // Show error message
    errorText.textContent = 'Network error occurred. Please check your connection and try again.';
    errorMsg.style.display = 'block';
    
    // Reset button state
    resetButtonState();
  });
}

function resetButtonState() {
  var btn = document.getElementById('voltxt-confirm-btn');
  var loadingMsg = document.getElementById('loading-message');
  
  paymentProcessing = false;
  btn.disabled = false;
  btn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
  var icon = btn.querySelector('.btn-icon');
  if (icon) icon.innerHTML = '<i class="fa-solid fa-arrow-right"></i>';
  btn.querySelector('.btn-text').textContent = '{{ button_confirm }}';
  loadingMsg.style.display = 'none';
}

// Alternative jQuery version if your OpenCart uses jQuery
$(document).ready(function() {
  // If you prefer jQuery, you can replace the fetch() above with:
  /*
  $.ajax({
    url: '{{ create_session_url }}',
    type: 'POST',
    dataType: 'json',
    success: function(data) {
      if (data.success && data.payment_url) {
        console.log('Payment session created successfully:', data);
        window.location.href = data.payment_url;
      } else {
        console.error('Payment session creation failed:', data);
        $('#error-text').text(data.error || 'Failed to create payment session.');
        $('#error-message').show();
        resetButtonState();
      }
    },
    error: function(xhr, status, error) {
      console.error('AJAX error:', error);
      $('#error-text').text('Network error occurred. Please try again.');
      $('#error-message').show();
      resetButtonState();
    }
  });
  */
});
</script>